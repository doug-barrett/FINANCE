fileVersion: 1
id: 38b83add-a489-4eec-ab95-db8710f98a49
name: FCT_LICENSE_UTILIZATION
operation:
  config:
    groupByAll: false
    insertStrategy: UNION ALL
    orderby: false
    orderbycolumn:
      items:
        - {}
    postSQL: ""
    preSQL: ""
    selectDistinct: false
    testsEnabled: false
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0fe604b-a1f7-468b-a1f1-cc24a8fd7c6a
          stepCounter: 38b83add-a489-4eec-ab95-db8710f98a49
        config: {}
        dataType: STRING
        description: |-
          -  Represents the unique identifier for the account associated with the opportunity. 
          - Sourced from the 'opportunity' table's 'account_id' column. 
          - Used for joining and linking with the account table to access account-specific information.
        name: account_id
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b9b3074-7a81-4a40-ab8c-e88473e5b73f
                stepCounter: 5994dc7e-6812-4e60-8d04-aa52bc60c22e
            transform: DISTINCT `FCT_CURRENT_ACCOUNT_LICENSES`.`account_id`
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5854281b-04a4-4b22-a82f-6e9c8734b9a3
          stepCounter: 38b83add-a489-4eec-ab95-db8710f98a49
        config: {}
        dataType: STRING
        description: ""
        name: account_name
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d54a46a-c326-4e60-9249-83d182d640a3
                stepCounter: 5994dc7e-6812-4e60-8d04-aa52bc60c22e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4dd94da1-1cd6-469f-a341-9cc2fd500213
          stepCounter: 38b83add-a489-4eec-ab95-db8710f98a49
        config: {}
        dataType: DATE
        description: ""
        name: month_start
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bbad7f0-b8a1-47ee-8afe-57ae6a96c3c7
                stepCounter: 5994dc7e-6812-4e60-8d04-aa52bc60c22e
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 4c5c1719-d63f-450d-a420-41691ec7ebca
          stepCounter: 38b83add-a489-4eec-ab95-db8710f98a49
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: arr_cohort
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 077efbf6-2b8a-4646-9bfa-c0d6ee16e246
                stepCounter: 5042476b-f373-45bd-8ff5-fac59ae70197
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 7c0128c2-b1f9-4e29-9afa-d797b03d1229
          stepCounter: 38b83add-a489-4eec-ab95-db8710f98a49
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: account_tenure
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d87bb61-5da4-49b9-8ba2-fda351bd8b91
                stepCounter: 5042476b-f373-45bd-8ff5-fac59ae70197
            transform: ""
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d48f5dde-7639-46f1-b309-7e6059424137
          stepCounter: 38b83add-a489-4eec-ab95-db8710f98a49
        config: {}
        dataType: INTEGER
        description: ""
        name: license_count
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d41a070f-6c31-4411-bb8c-ac69a7280191
                stepCounter: 5994dc7e-6812-4e60-8d04-aa52bc60c22e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d71ebdf-da5e-4984-89e5-a5a503d20395
          stepCounter: 38b83add-a489-4eec-ab95-db8710f98a49
        config: {}
        dataType: INTEGER
        description: ""
        name: licensed_users
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27f09901-4f7b-44d5-a077-d95e9b6e5773
                stepCounter: 2dfbcf28-bc1e-41fd-b33b-a936066289ec
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 929b4e00-0c5c-4ee3-a0ce-54fe4eface63
          stepCounter: 38b83add-a489-4eec-ab95-db8710f98a49
        config: {}
        dataType: DOUBLE
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: license_utilization
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TRY_DIVIDE(`FCT_LICENSED_USERS_BY_ACCOUNT`.`licensed_users`, `FCT_CURRENT_ACCOUNT_LICENSES`.`license_count`)
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGING
            nodeName: STG_ACCOUNT_MONTH_DETAIL
          - locationName: TARGET
            nodeName: FCT_CURRENT_ACCOUNT_LICENSES
          - locationName: TARGET
            nodeName: FCT_LICENSED_USERS_BY_ACCOUNT
        join:
          joinCondition: |-
            FROM {{ ref('TARGET', 'FCT_CURRENT_ACCOUNT_LICENSES') }} `FCT_CURRENT_ACCOUNT_LICENSES`
            INNER JOIN {{ ref('TARGET', 'FCT_LICENSED_USERS_BY_ACCOUNT') }} `FCT_LICENSED_USERS_BY_ACCOUNT`
            ON `FCT_CURRENT_ACCOUNT_LICENSES`.`account_id` = `FCT_LICENSED_USERS_BY_ACCOUNT`.`account_id`
            LEFT JOIN {{ ref('STAGING', 'STG_ACCOUNT_MONTH_DETAIL') }} `STG_ACCOUNT_MONTH_DETAIL`
            ON `FCT_CURRENT_ACCOUNT_LICENSES`.`account_id` = `STG_ACCOUNT_MONTH_DETAIL`.`account_id`
            AND `STG_ACCOUNT_MONTH_DETAIL`.`month_start` = DATE_TRUNC('month',GETDATE())
        name: FCT_LICENSE_UTILIZATION
        noLinkRefs: []
  name: FCT_LICENSE_UTILIZATION
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
